<!DOCTYPE html>

<html>
	<head>
		<title>Projection d'objets de dimension n sur un plan</title>
		<link href="../../Style.css" rel="stylesheet" type="text/css">
		<link href="4D.css" rel="stylesheet" type="text/css">
		<meta charset="UTF-8">

		<script type="text/javascript" async src="../../MathJax/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	</head>

	<body>
    <h1>Affichage en perspective d'objets de dimension \(n\)</h1>

		<h2>Projection sur un plan orienté</h2>

    <p>
      On cherche à projeter <strong>en perspective</strong> un objet de \(E=\mathbb{R}^n\), d'origine \(O=(0,0,...0)\), muni du produit scalaire usuel, sur un plan \(F\).
      <br>
      Pour cela, il nous faut un point de vue \(C \neq O\) (afin de simplifier les calculs, le regard sera en direction de l'origine \(O\)).
			<br>
      On choisit ensuite un plan \(F \subseteq \left(\overrightarrow{OC}\right)^{\perp}\) muni d'une base orthonormée et orientée \((f_1, f_2)\).
      <br>
    </p>
    <p>
      Soit \(M \in E\), son projeté en perspective sur \(F\) est dans l'intersection \(I\) de \(F\) et \((CM)\).
      Afin de pouvoir le projeter, il est nécéssaire qu'il n'apartienne pas au plan affine \(F + C\), en effet :

      $$I \subseteq \left(\overrightarrow{OC}\right)^{\perp} \cap (CM) = \left\{P \in E ~ | ~ \left\langle\overrightarrow{OP}, \overrightarrow{OC}\right\rangle = 0 \right\} \cap \left\{P \in E ~ | ~ \exists k \in \mathbb{R} : \overrightarrow{CP} = k \cdot \overrightarrow{CM}\right\}$$

			$$I \subseteq \left(\overrightarrow{OC}\right)^{\perp} \cap (CM) = \left\{P \in E ~ | ~ \exists k \in \mathbb{R} : \overrightarrow{CP} = k \cdot \overrightarrow{CM} ~ \text{et} ~ \left\langle\overrightarrow{OP}, \overrightarrow{OC}\right\rangle = 0 \right\}$$

			$$I \subseteq \left(\overrightarrow{OC}\right)^{\perp} \cap (CM) = \left\{P \in E ~ | ~ \exists k \in \mathbb{R} : \overrightarrow{CP} = k \cdot \overrightarrow{CM} ~ \text{et} ~ \left\langle\overrightarrow{OC} + \overrightarrow{CP}, \overrightarrow{OC}\right\rangle = 0 \right\}$$

			$$I \subseteq \left(\overrightarrow{OC}\right)^{\perp} \cap (CM) = \left\{P \in E ~ | ~ \exists k \in \mathbb{R} : \overrightarrow{CP} = k \cdot \overrightarrow{CM} ~ \text{et} ~ \left\|\overrightarrow{OC}\right\|^2 + \left\langle\overrightarrow{CP}, \overrightarrow{OC}\right\rangle = 0 \right\}$$

			$$I \subseteq \left(\overrightarrow{OC}\right)^{\perp} \cap (CM) = \left\{P \in E ~ | ~ \exists k \in \mathbb{R} : \overrightarrow{CP} = k \cdot \overrightarrow{CM} ~ \text{et} ~ \left\|\overrightarrow{OC}\right\|^2 + k \cdot \left\langle\overrightarrow{CM}, \overrightarrow{OC}\right\rangle = 0 \right\}$$

			Si \(M \in \left(C + \left(\overrightarrow{OC}\right)^{\perp}\right)\), alors en particulier \(\overrightarrow{CM} \in F \subseteq \left(\overrightarrow{OC}\right)^{\perp}\), d'où \(\left\langle\overrightarrow{CM}, \overrightarrow{OC}\right\rangle = 0\).
			<br>
			On a alors que \(F \cap (CM) \subseteq \left\{P \in E ~ | ~ \exists k \in \mathbb{R} : \overrightarrow{CP} = k \cdot \overrightarrow{CM} ~ \text{et} ~ \left\|\overrightarrow{OC}\right\|^2 = 0 \right\} = \emptyset\), car \(C \neq O\).
			<br>

			En revanche, si \(M \not\in \left(C + \left(\overrightarrow{OC}\right)^{\perp}\right)\), alors \(\left\langle\overrightarrow{CM}, \overrightarrow{OC}\right\rangle \neq 0\) et on peut calculer \(k\) :

			$$k = -\frac{\left\|\overrightarrow{OC}\right\|^2}{\left\langle\overrightarrow{CM}, \overrightarrow{OC}\right\rangle} = \frac{\left\|\overrightarrow{OC}\right\|^2}{\left\langle\overrightarrow{MC}, \overrightarrow{OC}\right\rangle}$$

			On peut enfin calculer \(I\) ! Il est vide si \(M' = C + k \cdot \overrightarrow{CM} \not\in F\), et égal au singleton \(\{M'\}\) dans le cas contraire.
    </p>

		<p>
			Comment déterminer si \(M\) appartient à \(F\) ?
			On possède une base de \(F\), on peut en tirer une paramétrisation du plan, mais cela ne nous permet pas de vérifier si \(M\) est bien dans \(F\).
			<br>
			On cherche alors à décrire \(F\) par un système de \(n-2\) équations linéaires homogènes.
			<br>
			Soit \(M = (x_i)_{i \leq n} = a f_1 + b f_2 \in F\).

			$$(L_i) : x_i = a f_{1,i} + b f_{2,i}, ~ i \leq n$$

			Soit \(k\) tel que \(f_{1,k} \neq 0\), on construit le nouveau système : \((L_i) - \frac{f_{1,i}}{f_{1,k}} (L_k) \longrightarrow (L'_i), ~ i \leq n\)

			$$(L'_i) : x_i - \frac{f_{1,i}}{f_{1,k}} x_k = b f_{2,i} - b \frac{f_{1,i}}{f_{1,k}} f_{2,k}$$

			$$(L'_i) : x_i - \frac{f_{1,i}}{f_{1,k}} x_k = b \left(f_{2,i} - \frac{f_{1,i}}{f_{1,k}} f_{2,k}\right)$$

			$$(L'_i) : x_i - \frac{f_{1,i}}{f_{1,k}} x_k = b \frac{f_{2,i}f_{1,k} - f_{1,i} f_{2,k}}{f_{1,k}}$$

			On pose \(\alpha_i = \frac{f_{1,i}}{f_{1,k}}\) et \(\beta_i = \frac{f_{2,i}f_{1,k} - f_{1,i} f_{2,k}}{f_{1,k}}\).
			<br>
			Soit \(l\) tel que \(\beta_l \neq 0\), on effectue l'opération \((L'_i) - \frac{\beta_i}{\beta_l} (L'_l) \longrightarrow (L''_i), ~ i \leq n\)

			$$(L''_i) : x_i - \alpha_i x_k - \frac{\beta_i}{\beta_l}(x_l - \alpha_l x_k) = 0$$

			$$(L''_i) : x_i - \frac{f_{1,i}}{f_{1,k}} x_k - \frac{\frac{f_{2,i}f_{1,k} - f_{1,i} f_{2,k}}{f_{1,k}}}{\frac{f_{2,l}f_{1,k} - f_{1,l} f_{2,k}}{f_{1,k}}}\left(x_l - \frac{f_{1,l}}{f_{1,k}} x_k\right) = 0$$

			$$(L''_i) : x_i - \frac{f_{1,i}}{f_{1,k}} x_k - \frac{f_{2,i}f_{1,k} - f_{1,i} f_{2,k}}{f_{2,l}f_{1,k} - f_{1,l} f_{2,k}}\left(x_l - \frac{f_{1,l}}{f_{1,k}} x_k\right) = 0$$

			$$(L''_i) : f_{1,k} x_i - f_{1,i} x_k - \frac{f_{2,i}f_{1,k} - f_{1,i} f_{2,k}}{f_{2,l}f_{1,k} - f_{1,l} f_{2,k}}\left(f_{1,k} x_l - f_{1,l} x_k\right) = 0$$

			\(F\) est ainsi décrit par les équations \((L''_i)_{i \neq k, l}\).
		</p>

		<h2>Récupération des coordonnées écran</h2>

		<p>
			On obtient finalement les coordonnées de \(M'\) à l'écran :
			\(\widetilde{M} = \left(
				\begin{array}{c}
					\left\langle\overrightarrow{OM'}, f1\right\rangle \\
					\left\langle\overrightarrow{OM'}, f2\right\rangle \\
				\end{array}
				\right)
			\)
		</p>

		<h2>Détermination de la visibilité</h2>

		<p>
			Pour construire l'écran \(S \subseteq F\), qui est un rectangle, on a besoin de deux données : l'angle de vision horizontal \(\alpha > 0\) et l'angle de vision vertical \(\beta > 0\).
			<br>
			De celles-ci on déduit les dimensions de l'écran : la largeur \(w = \tan \alpha \cdot \left\|\overrightarrow{OC}\right\|\) et la hauteur \(h = \tan \beta \cdot \left\|\overrightarrow{OC}\right\|\).
		</p>

		<p>
			Si on a \(\left|\widetilde{M}_x\right| > w\) ou \(\left|\widetilde{M}_y\right| > h\), alors le point est hors-champ.
			<br>
			Si \(M'\) vérifie \(\left\langle\overrightarrow{MM'},\overrightarrow{MC}\right\rangle < 0\), alors c'est que le point à projeter est entre l'écran et le point de vue, il est donc également hors-champ.
		</p>
		<img src="Images/Ecran.svg">
		<h2>Algorithme résumé</h2>
		<p>
			Il faut préalablement avoir calculé les coefficients des équations \((L_i)_{i \neq k, l}\).
		</p>
    <p><b>Entrée</b> : \(M \in \mathbb{R}^n\)
      <ol class="algorithm">
        <li>
          Si \(\left\langle\overrightarrow{MC}, \overrightarrow{OC}\right\rangle \neq 0\)
          <ol class="algorithm">
            <li>
              \(M' = C + \frac{\left\|\overrightarrow{OC}\right\|^2}{\left\langle\overrightarrow{MC}, \overrightarrow{OC}\right\rangle} \cdot \overrightarrow{CM}\)
            </li>
            <li>
              Si \(M' \in F\), c'est à dire s'il vérifie le système d'équations \((L_i)_{i \neq k, l}\)
              <ol class="algorithm">
                <li>
                  On calcule \(\widetilde{M} = \left(
            				\begin{array}{c}
            					\left\langle\overrightarrow{OM'}, f1\right\rangle \\
            					\left\langle\overrightarrow{OM'}, f2\right\rangle \\
            				\end{array}
            				\right)
            			\)
                </li>
                <li>
                  Si \(\left|\widetilde{M}_x\right| \leq w\), \(\left|\widetilde{M}_y\right| \leq h\) et \(\left\langle\overrightarrow{MM'},\overrightarrow{MC}\right\rangle \geq 0\)
                  <ol class="algorithm">
                    <li>
                      <b>Sortie</b> : On affiche \(\widetilde{M}\) à l'écran après avoir adapté à la résolution de l'écran.
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </p>
	</body>
</html>
